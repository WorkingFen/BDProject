CREATE TABLE audytor (
    numer_identyfikacyjny   INTEGER NOT NULL
);

ALTER TABLE audytor ADD CONSTRAINT audytor_pk PRIMARY KEY ( numer_identyfikacyjny );

CREATE TABLE basen (
    numer_obiektu             INTEGER NOT NULL,
    nazwa_obiektu             VARCHAR2(4000) NOT NULL,
    liczba_torow_plywackich   INTEGER NOT NULL,
    miasto                    VARCHAR2(4000),
    ulica                     VARCHAR2(4000)
);

ALTER TABLE basen ADD CONSTRAINT basen_pk PRIMARY KEY ( numer_obiektu );

CREATE TABLE dane_do_logowania (
    id                            INTEGER NOT NULL,
    login                         VARCHAR2(4000) NOT NULL,
    haslo                         VARCHAR2(4000) NOT NULL,
    numer_identyfikacyjny_a       INTEGER,
    numer_identyfikacyjny_w       INTEGER,
    osoba_numer_identyfikacyjny   INTEGER NOT NULL
);

CREATE UNIQUE INDEX dane_do_logowania__idx ON
    dane_do_logowania (
        osoba_numer_identyfikacyjny
    ASC );

ALTER TABLE dane_do_logowania ADD CONSTRAINT dane_do_logowania_pk PRIMARY KEY ( id );

CREATE TABLE klient (
    numer_klienta    INTEGER NOT NULL,
    imie             VARCHAR2(4000) NOT NULL,
    nazwisko         VARCHAR2(4000) NOT NULL,
    numer_telefonu   VARCHAR2(4000) NOT NULL,
    "Adres_e-mail"   VARCHAR2(4000)
);

ALTER TABLE klient ADD CONSTRAINT klient_pk PRIMARY KEY ( numer_klienta );

CREATE TABLE koszyk (
    transakcja_numer_transakcji   INTEGER NOT NULL,
    usluga_numer_uslugi           INTEGER NOT NULL,
    ilosc                         INTEGER NOT NULL
);

ALTER TABLE koszyk ADD CONSTRAINT koszyk_pk PRIMARY KEY ( usluga_numer_uslugi,
                                                          transakcja_numer_transakcji );

CREATE TABLE lekcja_plywania (
    numer_lekcji              INTEGER NOT NULL,
    data                      DATE NOT NULL,
    godzina                   DATE NOT NULL,
    numer_ratownika           INTEGER NOT NULL,
    liczba_zapisanych_osob    INTEGER NOT NULL,
    klient_numer_klienta      INTEGER NOT NULL,
    ogolna_numer_uslugi       INTEGER NOT NULL,
    liczba_zapisanych_osob2   INTEGER NOT NULL
);

ALTER TABLE lekcja_plywania ADD CONSTRAINT lekcja_plywania_pk PRIMARY KEY ( numer_lekcji );

CREATE TABLE lokalna (
    numer_uslugi   INTEGER NOT NULL
);

ALTER TABLE lokalna ADD CONSTRAINT lokalna_pk PRIMARY KEY ( numer_uslugi );

CREATE TABLE ogolna (
    numer_uslugi   INTEGER NOT NULL
);

ALTER TABLE ogolna ADD CONSTRAINT ogolna_pk PRIMARY KEY ( numer_uslugi );

CREATE TABLE osoba (
    numer_identyfikacyjny   INTEGER NOT NULL,
    audytor_numer_id        INTEGER,
    wlasciciel_numer_id     INTEGER,
    pracownik_numer_id      INTEGER
);

ALTER TABLE osoba
    ADD CONSTRAINT fkarc_5 CHECK ( ( ( audytor_numer_id IS NOT NULL )
                                     AND ( wlasciciel_numer_id IS NULL )
                                     AND ( pracownik_numer_id IS NULL ) )
                                   OR ( ( wlasciciel_numer_id IS NOT NULL )
                                        AND ( audytor_numer_id IS NULL )
                                        AND ( pracownik_numer_id IS NULL ) )
                                   OR ( ( pracownik_numer_id IS NOT NULL )
                                        AND ( audytor_numer_id IS NULL )
                                        AND ( wlasciciel_numer_id IS NULL ) ) );

ALTER TABLE osoba ADD CONSTRAINT osoba_pk PRIMARY KEY ( numer_identyfikacyjny );

CREATE TABLE pracownik (
    numer_identyfikacyjny         INTEGER NOT NULL,
    imie                          VARCHAR2(4000) NOT NULL,
    nazwisko                      VARCHAR2(4000) NOT NULL,
    dodatek_do_pensji             INTEGER,
    stanowisko_numer_stanowiska   INTEGER NOT NULL,
    basen_numer_obiektu           INTEGER NOT NULL
);

ALTER TABLE pracownik ADD CONSTRAINT pracownik_pk PRIMARY KEY ( numer_identyfikacyjny );

CREATE TABLE przeglad (
    numer_przegladu       INTEGER NOT NULL,
    data                  DATE NOT NULL,
    basen_numer_obiektu   INTEGER NOT NULL
);

ALTER TABLE przeglad ADD CONSTRAINT przeglad_pk PRIMARY KEY ( numer_przegladu );

CREATE TABLE rezerwacja_toru (
    numer_rezerwacji       INTEGER NOT NULL,
    data                   DATE NOT NULL,
    godzina                DATE NOT NULL,
    numer_toru             INTEGER NOT NULL,
    status                 CHAR(1) NOT NULL,
    klient_numer_klienta   INTEGER NOT NULL,
    ogolna_numer_uslugi    INTEGER NOT NULL
);

ALTER TABLE rezerwacja_toru ADD CONSTRAINT rezerwacja_toru_pk PRIMARY KEY ( numer_rezerwacji );

CREATE TABLE stanowisko (
    numer_stanowiska   INTEGER NOT NULL,
    nazwa              VARCHAR2(4000) NOT NULL,
    wynagrodzenie      INTEGER NOT NULL
);

ALTER TABLE stanowisko ADD CONSTRAINT stanowisko_pk PRIMARY KEY ( numer_stanowiska );

CREATE TABLE transakcja (
    numer_transakcji   INTEGER NOT NULL,
    data               DATE NOT NULL
);

ALTER TABLE transakcja ADD CONSTRAINT transakcja_pk PRIMARY KEY ( numer_transakcji );

CREATE TABLE usluga (
    numer_uslugi           INTEGER NOT NULL,
    nazwa_uslugi           VARCHAR2(4000) NOT NULL,
    cena                   INTEGER NOT NULL,
    basen_numer_obiektu    INTEGER NOT NULL,
    ogolna_numer_uslugi    INTEGER,
    lokalna_numer_uslugi   INTEGER
);

ALTER TABLE usluga
    ADD CONSTRAINT fkarc_6 CHECK ( ( ( ogolna_numer_uslugi IS NOT NULL )
                                     AND ( lokalna_numer_uslugi IS NULL ) )
                                   OR ( ( lokalna_numer_uslugi IS NOT NULL )
                                        AND ( ogolna_numer_uslugi IS NULL ) ) );

ALTER TABLE usluga ADD CONSTRAINT usluga_pk PRIMARY KEY ( numer_uslugi );

CREATE TABLE wlasciciel (
    numer_identyfikacyjny   INTEGER NOT NULL,
    imie                    VARCHAR2(4000) NOT NULL,
    nazwisko                VARCHAR2(4000) NOT NULL
);

ALTER TABLE wlasciciel ADD CONSTRAINT wlasciciel_pk PRIMARY KEY ( numer_identyfikacyjny );

ALTER TABLE dane_do_logowania
    ADD CONSTRAINT dane_do_logowania_osoba_fk FOREIGN KEY ( osoba_numer_identyfikacyjny )
        REFERENCES osoba ( numer_identyfikacyjny );

ALTER TABLE koszyk
    ADD CONSTRAINT koszyk_transakcja_fk FOREIGN KEY ( transakcja_numer_transakcji )
        REFERENCES transakcja ( numer_transakcji );

ALTER TABLE koszyk
    ADD CONSTRAINT koszyk_usluga_fk FOREIGN KEY ( usluga_numer_uslugi )
        REFERENCES usluga ( numer_uslugi );

ALTER TABLE lekcja_plywania
    ADD CONSTRAINT lekcja_plywania_klient_fk FOREIGN KEY ( klient_numer_klienta )
        REFERENCES klient ( numer_klienta );

ALTER TABLE lekcja_plywania
    ADD CONSTRAINT lekcja_plywania_ogolna_fk FOREIGN KEY ( ogolna_numer_uslugi )
        REFERENCES ogolna ( numer_uslugi );

ALTER TABLE osoba
    ADD CONSTRAINT osoba_audytor_fk FOREIGN KEY ( audytor_numer_id )
        REFERENCES audytor ( numer_identyfikacyjny );

ALTER TABLE osoba
    ADD CONSTRAINT osoba_pracownik_fk FOREIGN KEY ( pracownik_numer_id )
        REFERENCES pracownik ( numer_identyfikacyjny );

ALTER TABLE osoba
    ADD CONSTRAINT osoba_wlasciciel_fk FOREIGN KEY ( wlasciciel_numer_id )
        REFERENCES wlasciciel ( numer_identyfikacyjny );

ALTER TABLE pracownik
    ADD CONSTRAINT pracownik_basen_fk FOREIGN KEY ( basen_numer_obiektu )
        REFERENCES basen ( numer_obiektu );

ALTER TABLE pracownik
    ADD CONSTRAINT pracownik_stanowisko_fk FOREIGN KEY ( stanowisko_numer_stanowiska )
        REFERENCES stanowisko ( numer_stanowiska );

ALTER TABLE przeglad
    ADD CONSTRAINT przeglad_basen_fk FOREIGN KEY ( basen_numer_obiektu )
        REFERENCES basen ( numer_obiektu );

ALTER TABLE rezerwacja_toru
    ADD CONSTRAINT rezerwacja_toru_klient_fk FOREIGN KEY ( klient_numer_klienta )
        REFERENCES klient ( numer_klienta );

ALTER TABLE rezerwacja_toru
    ADD CONSTRAINT rezerwacja_toru_ogolna_fk FOREIGN KEY ( ogolna_numer_uslugi )
        REFERENCES ogolna ( numer_uslugi );

ALTER TABLE usluga
    ADD CONSTRAINT usluga_basen_fk FOREIGN KEY ( basen_numer_obiektu )
        REFERENCES basen ( numer_obiektu );

ALTER TABLE usluga
    ADD CONSTRAINT usluga_lokalna_fk FOREIGN KEY ( lokalna_numer_uslugi )
        REFERENCES lokalna ( numer_uslugi );

ALTER TABLE usluga
    ADD CONSTRAINT usluga_ogolna_fk FOREIGN KEY ( ogolna_numer_uslugi )
        REFERENCES ogolna ( numer_uslugi );
